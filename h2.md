**Tehtävät**

x) Lue/katso/kuuntele ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.)

    OWASP: OWASP Top 10: A01 Broken Access Control

    Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf

    PortSwigger: Access control vulnerabilities and privilege escalation

    Karvinen 2006: Raportin kirjoittaminen

    Vapaaehtoinen: PortSwigger 2020: What is SQL injection? - Web Security Academy (noin 10 min video)

a) Murtaudu 010-staff-only. Ks. Karvinen 2024: Hack'n Fix

b) Korjaa 010-staff-only haavoittuvuus lähdekoodista. Osoita testillä, että ratkaisusi toimii.

c) Ratkaise dirfuzt-1 artikkelista Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf. Tämä auttaa 020-your-eyes-only ratkaisemisessa.

d) Murtaudu 020-your-eyes-only. Ks. Karvinen 2024: Hack'n Fix

e) Korjaa 020-your-eyes-only haavoittuvuus. Osoita testillä, että ratkaisusi toimii.

g) Vapaaehtoinen. Johdantotehtävä, joka auttaa 010-staff-only ratkaisemisessa. Ratkaise Portswigger Academyn "Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data".

h) Vapaaehtoinen. Johdantotehtävä, joka auttaa 010-staff-only ratkaisemisessa. Ratkaise Portswigger Academyn "Lab: SQL injection vulnerability allowing login bypass"

**Ympäristö**

Tehtävän suorittamiseen käytin seuraavanlaista tietokonetta:

Lenovo X1 /Intel Core Ultra 7 155U/14WUXGA/32GB/1Tt SSD/5G/W11P/Intel Wi-Fi 6E AX211

Virtualboxissa Debian 13.0 amd64 xfce Linux

># x)

># a)

Päätin aloittaa tämän tehtävän suorittamisen tekemällä ensin g- ja h-kohdan vapaaehtoiset johdantotehtävät. Sitä ennen tein uuden Linux-koneen tehtäviä varten.

Ajoin koneelle  ohjeen mukaisesti:

>sudo apt-get update

>sudo apt-get -y install wget unzip micro

<img width="813" height="297" alt="image" src="https://github.com/user-attachments/assets/778c048e-851e-41bb-9598-881b1f4c49b3" />

>wget https://terokarvinen.com/hack-n-fix/teros-challenges.zip

>unzip teros-challenges.zip

Latasin Teron sivuilta tiedoston 

<img width="832" height="295" alt="image" src="https://github.com/user-attachments/assets/fcf17212-e77e-4c7b-8897-219ccb12d666" />

ja purin sen auki

<img width="815" height="310" alt="image" src="https://github.com/user-attachments/assets/3a160ad4-9a1e-4d0c-a096-5a4875d92d4b" />

Yritin seuraavaksi ohjeen mukaan kirjoitella komentoja, joista tuli virheilmoitus, mutta jatkoin eteenpäin ja asensin python3-flask jne..

<img width="1072" height="457" alt="image" src="https://github.com/user-attachments/assets/5ff1cc15-55c1-4088-9c56-46941203af21" />

Käynnistin serverin ja surffasin ko. osoitteeseen (http://127.0.0.1:5000):

<img width="1046" height="222" alt="image" src="https://github.com/user-attachments/assets/52d32ba0-b53d-4ea7-8180-567a905023c0" />

Ja sieltähän se ensimmäinen maali lopulta löytyi:

<img width="1872" height="816" alt="image" src="https://github.com/user-attachments/assets/52d3121d-1c0e-4980-8c38-b9a5bc2b0d07" />

Huomasin tässä kohtaa, kun katsoin vihjeitä Portswiggeristä, että joudun ilmeisesti lataamaan seuravaksi burp Suiten, joten tein sen seuraavaksi.

Kokeilin useamman tunnin opiskella Burpin käyttöä ja katselin videoita, mutta olin ihan jumissa. Katsoin (Youtubesta) videon, jolla ratkaistaan Lab: SQL injection

vulnerability allowing login bypass ja siitä sainkin ensimmäisen idean kokeilla muokata lähetettävää tietoa ja onnistuin saamaan internal server errorin lähettämällä

palvelimelle ( pin = ') ja tämä on videon mukaan ainakin hyvä asia jo.

<img width="1476" height="569" alt="image" src="https://github.com/user-attachments/assets/c811da57-29a9-4afa-860e-97af63ed5785" />

<img width="986" height="234" alt="image" src="https://github.com/user-attachments/assets/2e97cb02-9984-46c0-ab6c-044087b99bc9" />

Yritin useamman tunnin tuohon pin-koodin kohtaan kirjoittaa jotain muuta, välillä internetistä erilaisia videoita katsellen ja sql injektion perusteita selaillen, mutta en saanut edistystä millään.

Huomasin sitten vinkeistä, että voisin käyttää kehittäjän työkaluja ja tutkia lähdekoodia. Ymmärsin kyllä tehtävänannosta, että sitä ei saisi tehdä, joten kokeilin ilman. Vihjeen mukaan tutkin kenttää, joka otti ainoastaan vastaan numeroita ja syynä

selkeästi oli html-koodissa > input type= number. Mietin, että jos tuohon vaihtaisi number tilalle  ensin text ja asitten syöttäisi injektion kenttään, niin olisiko siitä hyötyä.

<img width="1287" height="714" alt="image" src="https://github.com/user-attachments/assets/9f9ff7e3-0419-4f1f-a302-a2e202978704" />

Kokeilin kenttään syöttää tuon Teron vihjeessä mainitun OR 1=1; --

>>SQL injection
"SELECT * FROM foo WHERE true", matches each line where WHERE is true.
Often used as "authentication bypass" or "login bypass", you can add "OR 1=1", a clause that's always true. And "false or true" is still true.
To get rid of the end of SQL query, you can use comment "-- " or write query to have the correct strings etc. open or close.
Often only the first row of results is shown. Use "LIMIT offset, count" to get second, third etc result. For example, "LIMIT 2,1" shows results starting from 2, show 1 result.
Use database library facilities to combine user data with SQL. This is often called "prepared queries" or "parametrized queries"
This code uses SQLAlchemy for the database library>>

<img width="621" height="510" alt="image" src="https://github.com/user-attachments/assets/af49f4b0-a964-434f-a940-700b41101d77" />

<img width="917" height="529" alt="image" src="https://github.com/user-attachments/assets/c5d7ab6c-d0d9-4566-aae1-3ebd5e29f21d" />

Mitään ei kuitenkaan tapahtunut, sivu näytti tältä:

<img width="770" height="461" alt="image" src="https://github.com/user-attachments/assets/2d685c56-fba7-4c8b-8e3a-f96e396c75cc" />

Palasin katsomaan netistä aineistoja ja huomasin, että niissä tuon lausekkeen ympärillä, edessä ja takana oli käytetty hipsuja, joten ajattelin kokeilla kirjoittaa kenttään seuraavaksi:

'OR 1=1; -- ' ja painoin lähetä. Nyt tapahtui jotakin uutta. Salasanaksi tuli foo..

<img width="764" height="664" alt="image" src="https://github.com/user-attachments/assets/fb365372-6b8a-4391-adcc-e416bcb2f2a4" />





















># b)

># c)

># d)

># e)

># f)

># g)

Aloitin tehtä

## Lähteet

Portswigger Academy, Access control vulnerabilities and privilege escalation, 2025. Luettavissa: https://portswigger.net/web-security/access-control. Luettu 29.8.2025

Lab: SQL injection vulnerability allowing login bypass, youtube: https://www.youtube.com/watch?v=ML3aGaloczI

Tero Karvinen, https://terokarvinen.com/hack-n-fix/
># h)
