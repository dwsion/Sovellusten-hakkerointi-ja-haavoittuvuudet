**Tehtävät**

h3 No strings attached (Tero)

Tiesitkö, että binääreistä saa tietoa jo ennen kuin ne ajaa? Tässä astutaan ensi viikon staattisen analyysin maailmaan.

Staattisen analyysin kruunaamaton kuningas 'strings' tervehtii meitä!

a) Strings. Lataa ezbin-challenges.zip Aja 'passtr'. Selvitä oikea salasana 'strings' avulla. Selvitä myös lippu. (Ensisijaisesti katsomatta sorsia, jos osaat.)

b) Tee passtr.c -ohjelmasta uusi versio, jossa salasana ei näy suoraan sellaisenaan binääristä. Osoita testillä, että salasana ei näy. (Obfuskointi riittää.)

c) Packd. Aja 'packd' paketista ezbin-challenges.zip. Mikä on salasana? Mikä on lippu? (Tämä tehtävä on hieman haastavampi. Kirjaa ylös kokeilemasi lähestymistavat ja keksimäsi hypoteesit. Toivottavasti pääset itse maaliin, mutta jos et, läpikävely paljastuu tunnilla...)

d) Vapaaehtoinen bonus: Cryptopals. Crypto Challenge Set 1. Tätä voi tehdä useamman viikon bonuksena. Jos saat ratkaistua kohdat 1 .. "4. Detect single-character XOR", olet jo astunut salakirjoituksen maailmaan.


## Ympäristö

Tehtävän suorittamiseen käytin seuraavanlaista tietokonetta:

Lenovo X1 /Intel Core Ultra 7 155U/14WUXGA/32GB/1Tt SSD/5G/W11P/Intel Wi-Fi 6E AX211

Virtualboxissa Debian 13.0 amd64 xfce Linux


># a)

Aloitin lataamalla zip.filen virtuaalikoneelle:

    wget https://terokarvinen.com/loota/yctjx7/ezbin-challenges.zip

<img width="1262" height="339" alt="image" src="https://github.com/user-attachments/assets/6a0dd871-9ba0-4b91-b7e6-bb52bbd81a0a" />

Unzippasin ja käynnistin ohjelman, joka kysyi salasanaa.

     unzip ezbin-challenges.zip

   ./passtr   -käynnisti ohjelman


<img width="800" height="41" alt="image" src="https://github.com/user-attachments/assets/a139865a-3fe4-4acc-8232-1204b181e532" />


Seuraavaksi googlasin, että mikä on strings / mitä se tekee ja sain seuraavaa tietoa:

>**strings** 

- on Unix-työkalu, joka etsii ja tulostaa binäärisistä tiedostoista kaikki tulostettavat merkkijonot
  
  (ASCII/UTF-8, joskus myös UTF-16), eli merkkejä, jotka ovat tavallisen tekstin kaltaisia:
  
  kirjaimia, numeroita, välimerkkejä jne.

- Binääritiedostoissa (esim. ohjelmat, kuvat, kirjastot) suurin osa on "raakatavua", jota ei voi
  
  lukea suoraan, mutta sinne saattaa jäädä kovakoodattuja merkkijonoja, kuten:

  salasanoja, tiedostonimiä, virheilmoituksia jne..

- Käyttökohteina analyysit ja sopii hakkerointiharjoituksiin.

- Voidaan nähdä kovakoodattuja tietoja binääristä ilman sen ajamista; salasanoja, verkkotunnuksia, ip-osoitteita, salausavaimia, harjoitusten merkattuja lippuja jne.

  (chatGPT)

Tässä tapauksessa sitä voisi käyttää seuraavasti:

        strings passtr    
        strings passtr | less     (selaus ruutu kerrallaan) ( q:lla pääsee ulos )

Kokeilin tuota komentoa ja sieltä listautui seuraavan näköisiä rivejä:

<img width="1241" height="537" alt="image" src="https://github.com/user-attachments/assets/2afcdd9f-c1b7-446a-97d2-67a73eccabc7" />

Veikkaan, että löysin salasanan. Kokeillaanpas.

<img width="775" height="111" alt="image" src="https://github.com/user-attachments/assets/c2b152b5-7b5b-4ce9-a04c-16ac54b91ebe" />

Mahtavaa, tämä toimii :)


Ajattelin vielä kokeilla tuota lipun hakua binääristä grepin avulla, josko se toimisi tässä.

        strings passtr | grep FLAG

<img width="741" height="63" alt="image" src="https://github.com/user-attachments/assets/20823a7d-5039-4807-b130-04fce6759edf" />

Merkattu lippu löytyi tällä komennolla suoraan, äskeisen selailun sijasta.





># b)

Avasin passtr.c- tiedoston microeditoriin.

        micro passtr.c


Sieltä löytyi seuraavanlainen koodi:

#include <stdio.h>
#include <string.h>

        int main() {
        	char password[20];
        	
        	printf("What's the password?\n");
        	scanf("%19s", password);
        	if (0 == strcmp(password, "sala-hakkeri-321")) {
        		printf("Yes! That's the password. FLAG{Tero-d75ee66af0a68663f15539ec0f46e3b1}\n");
        	} else {
        		printf("Sorry, no bonus.\n");
        	}
        	return 0;
        }

<img width="1094" height="390" alt="image" src="https://github.com/user-attachments/assets/295b1154-50da-46b4-a3f7-d8d7720cfefb" />

 **Obfuskointi** piti selvittää ensin ja sehän on siis: 

        Ohjelmakoodin muokkaaminen vaikeammin ymmärrettävään muotoon


Tähän käytin apuna keskustelua chat-GPT:n kanssa, koska minulla ei tähän riittäisi suoraan osaaminen. Tälläistä saimme aikaan:

<img width="1185" height="682" alt="image" src="https://github.com/user-attachments/assets/94b38906-4f52-4000-9770-16ab08c321e0" />

Käänsin seuraavaksi tiedoston ohjelmalle passtr:

        gcc -O2 -s passtr.c -o passtr

<img width="648" height="38" alt="image" src="https://github.com/user-attachments/assets/db04cfb5-edbb-43cd-929c-a9fc691491bf" />

Ja kokeilin näkyykö salasana edellen strins-haulla:

<img width="1052" height="290" alt="image" src="https://github.com/user-attachments/assets/86763aa2-e074-4643-9f94-1c30e9b68c2f" />

<img width="685" height="47" alt="image" src="https://github.com/user-attachments/assets/cfb5c789-90cb-4128-a8b7-22116b8ce74c" />


Ei näyttäisi näkyvän enään.




># c)

Ajoin seuraavaksi Packd-ohjelman, samalla tapaa kuin aiemmassa kohtaa edellisen ohjelman.

<img width="543" height="58" alt="image" src="https://github.com/user-attachments/assets/a2eb2b93-1cd7-4bbd-a238-c3d813c591a1" />

Näyttäisi siltä, että tietoja on pakattu jollain, jopa tiedoston nimi viittaa siihen.

Lähdin googlaamaan vaihtoehtoja, joilla tuo olisi voitu pakattu, ja löysin vaihtoehdoiksi Kiteshieldiä ja UPX:ää

UPX ( Basic Binary Packing) näyttäisi olevan yleisin vapaan lähdekoodin kaveri. Itseasiassa ensimmäinen rivi, joka listataan sanoo näin:

        wUPX!

<img width="481" height="40" alt="image" src="https://github.com/user-attachments/assets/eee84533-4372-474b-8236-fb87b72c0d07" />

ja kun kuvaa katsoo tarkemmin, niin siinä näyttäisi lukevan:

    strings packed with UPX !  hmm..

Mitenkäs tälläinen tiedosto sitten puretaan?

Barelycompetent -sivustolla listataan työkalun komentoja:

<img width="1552" height="1108" alt="image" src="https://github.com/user-attachments/assets/59321a49-f5ff-4334-93b9-804e03ef8d53" />


Kokeillaanpas sitten tuota ko. tapaa itse.

<img width="679" height="80" alt="image" src="https://github.com/user-attachments/assets/aa8ede68-75ac-4f35-96d6-45934c51b0a9" />

Tässä kohtaa tajusin, että sehän täytyy ladata ensin koneelle, joten tein sen seuraavaksi.

    sudo apt-get -y install upx

<img width="773" height="264" alt="image" src="https://github.com/user-attachments/assets/85a36a45-867a-42fa-a8e2-3ffcb7b9f095" />

<img width="985" height="517" alt="image" src="https://github.com/user-attachments/assets/a86d4df8-696b-4f50-977c-ca5b667e4d19" />


Sitten kokeillaan purkaa tiedostoa ja sehän onnistui:

<img width="943" height="211" alt="image" src="https://github.com/user-attachments/assets/ee1f9b19-8313-4128-87aa-cfac1a8d2320" />

Kokeillaanpas nyt uudelleen katsoa binäärin rivejä:

        strings packd

<img width="806" height="391" alt="image" src="https://github.com/user-attachments/assets/18d6652d-4a5f-4ff4-a33f-741c8859ff9a" />

Viimeisellä rivillä ennen onnistumisviestiä näyttäisi olevan nyt salasana, jota käyttää. Kokeilen sitä seuraavaksi.

<img width="855" height="117" alt="image" src="https://github.com/user-attachments/assets/d443a208-3438-4629-bea5-841425b2ab7d" />






># d)




### Lähteet

- Tero Karvinen, Sovellusten hakkerointi. luettavissa: https://terokarvinen.com/sovellusten-hakkerointi/, Luettu: 2.9.2025

- Barely competent, Intro to UPX Packing. luettavissa: https://barelycompetent.dev/pwnable-kr/flag/. Luettu: 2.9.2025

- ChatGPT5, Open AI. Käytetty: 2.9.2025

- Cryptopals, crypto challenges. luettavissa: https://www.cryptopals.com/sets/1

